# チュー太くん

- 機能追加&リファクタリング自由

**もしかしたら js 用の書式に変換されたことにより、正常に動かない可能性があるので Spreadsheet 上のスクリプトと合わせてご覧ください**

### 仕様

- 毎週金曜日の 0 時〜1 時に GAS がスプレッドシートをチェックしに行きます

- その前日（木曜日）が、「日程」シート内の課題の提出締切日と一致していれば、Slack に以下の通知が来ます

  - 通知の内容は、チュー太くんチャンネルに@channel で飛んできます

  - 今回の課題チェック用のシート url、担当者の名前と課題提出先 url が投げられますので、土曜日の授業前までに課題チェックしてください！！

- 課題の締め切りの有無にかかわらず、毎週土曜の朝の「チェック終わりましたかリマインド」と月曜の朝の「コメントしましたかリマインド」が飛びます（ここは今後の改善を期待）

### 使用技術

- GAS

- Google Spreadsheet

- Slack

- Incoming Webhooks

### 今後の開発

- ぜひ使いやすく発展させてほしいです。あると捗る機能を挙げたので作ってほしい。。。

  - 課題提出がある週のあとの土曜と月曜だけ、リマインドが走るようにしたい

  - リマインドはチェックとかコメントが終わっていない人に直接メンションで飛ばしたい

  - 接続先の設定をいちいち変えなくて済むようにしたい（これは提出フォームの運用にも関わってきそうなのでスタッフさんにも相談してくださいね）

  - 絵文字も定期的に変えて OK です、チュー太くんは動的型付け

### 設定方法

- Slack に Webhooks を設定して Spreadseet と接続する

  - 参考 URL [https://qiita.com/unadesuga/items/971c5f7587a7bf8d076d](https://qiita.com/unadesuga/items/971c5f7587a7bf8d076d)

  - Moment.js の読み込みも必要です。参考 URL[https://tonari-it.com/gas-moment-js-moment/](https://tonari-it.com/gas-moment-js-moment/)

    - Moment.js のプロジェクトキー：　 MHMchiX6c1bwSqGM1PZiW_PxhMjh3Sh48

  - 取得するデータの範囲を確認（29 行目付近）ここは生徒数によって変動するので設定が必要

- **シートが変わる度に接続先を変更する必要があるので、上記設定が必要です**
